# Test stack-utils - tests the builtin 2dup and 3drop operations

# 2drop is not a builtin, so define it here
: 2drop ( A B -- )
  drop drop
;

: main ( -- )
  # Test 2dup builtin
  # 1 2 2dup -> 1 2 1 2
  # Check top is 2 and second is 1, then clean up original 1 2
  1 2 2dup
  2 i.= swap 1 i.= and  # stack: 1 2 Bool
  nip nip               # drop the original 1 2, keep Bool
  if
    "2dup works ✓" io.write-line
  else
    "2dup FAILED" io.write-line
  then

  # Test 2drop: 5 10 15 -> 2drop -> 5
  5 10 15
  2drop
  5 i.=
  if
    "2drop works ✓" io.write-line
  else
    "2drop FAILED" io.write-line
  then

  # Test 3drop: 1 2 3 4 -> 3drop -> 1
  1 2 3 4
  3drop
  1 i.=
  if
    "3drop works ✓" io.write-line
  else
    "3drop FAILED" io.write-line
  then
;
