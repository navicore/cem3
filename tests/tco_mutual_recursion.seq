# TCO Mutual Recursion Test
#
# This test verifies that tail call optimization works for mutual recursion.
# Without TCO, this would cause a stack overflow.

: is-even ( Int -- Int )
    dup 0 i.= if
        drop 1
    else
        1 i.subtract is-odd
    then
;

: is-odd ( Int -- Int )
    dup 0 i.= if
        drop 0
    else
        1 i.subtract is-even
    then
;

: main ( -- )
    "Testing TCO with mutual recursion (100000 calls)..." io.write-line
    100000 is-even
    1 i.= if
        "Success! 100000 is even." io.write-line
    else
        "ERROR: 100000 should be even!" io.write-line
    then
    99999 is-odd
    1 i.= if
        "Success! 99999 is odd." io.write-line
    else
        "ERROR: 99999 should be odd!" io.write-line
    then
;
