# Test math.cem standard library

# Include math functions (inline for now - no module system yet)

# Absolute value
: abs ( Int -- Int )
  dup 0 < if
    0 swap subtract
  then
;

# Maximum of two values
: max ( Int Int -- Int )
  over over > if
    drop
  else
    nip
  then
;

# Minimum of two values
: min ( Int Int -- Int )
  over over < if
    drop
  else
    nip
  then
;

# Modulo operation
: mod ( Int Int -- Int )
  over over
  divide
  multiply
  subtract
;

# GCD using Euclidean algorithm
: gcd ( Int Int -- Int )
  dup 0 = if
    drop
  else
    over over mod
    rot drop
    gcd
  then
;

# Power (base^exp)
: pow ( Int Int -- Int )
  dup 0 = if
    drop drop 1
  else
    dup 1 = if
      drop
    else
      over
      swap 1 subtract
      pow
      multiply
    then
  then
;

# Sign function
: sign ( Int -- Int )
  dup 0 = if
    drop 0
  else
    dup 0 < if
      drop 0 1 subtract
    else
      drop 1
    then
  then
;

# Tests
: main ( -- )
  5 abs 5 = if "abs(5) = 5 ✓" write_line else "abs(5) FAILED" write_line then
  0 5 subtract abs 5 = if "abs(-5) = 5 ✓" write_line else "abs(-5) FAILED" write_line then

  3 7 max 7 = if "max(3,7) = 7 ✓" write_line else "max(3,7) FAILED" write_line then
  9 2 max 9 = if "max(9,2) = 9 ✓" write_line else "max(9,2) FAILED" write_line then

  3 7 min 3 = if "min(3,7) = 3 ✓" write_line else "min(3,7) FAILED" write_line then
  9 2 min 2 = if "min(9,2) = 2 ✓" write_line else "min(9,2) FAILED" write_line then

  48 18 gcd 6 = if "gcd(48,18) = 6 ✓" write_line else "gcd(48,18) FAILED" write_line then
  100 35 gcd 5 = if "gcd(100,35) = 5 ✓" write_line else "gcd(100,35) FAILED" write_line then

  2 0 pow 1 = if "pow(2,0) = 1 ✓" write_line else "pow(2,0) FAILED" write_line then
  2 3 pow 8 = if "pow(2,3) = 8 ✓" write_line else "pow(2,3) FAILED" write_line then
  5 2 pow 25 = if "pow(5,2) = 25 ✓" write_line else "pow(5,2) FAILED" write_line then

  0 5 subtract sign 0 1 subtract = if "sign(-5) = -1 ✓" write_line else "sign(-5) FAILED" write_line then
  0 sign 0 = if "sign(0) = 0 ✓" write_line else "sign(0) FAILED" write_line then
  5 sign 1 = if "sign(5) = 1 ✓" write_line else "sign(5) FAILED" write_line then
;
