# Test chan.send and chan.receive error handling
# Note: All channel operations now return success flags (errors are values, not crashes)

# Test chan.send with valid channel
: test-chan.send-success ( -- )
  chan.make  # create channel, get ID
  42 swap chan.send
  test.assert
;

# Test chan.send with invalid channel ID
: test-chan.send-invalid ( -- )
  42 999999 chan.send  # non-existent channel
  test.assert-not  # should return false (failure)
;

# Test chan.receive with valid channel
: test-chan.receive-success ( -- )
  chan.make  # create channel, get ID
  dup 42 swap chan.send  # send value, returns success flag
  drop  # drop send success flag
  chan.receive  # returns (value success_flag)
  test.assert  # success flag should be true
  42 test.assert-eq  # value should be 42
;

# Test chan.receive with invalid channel ID
: test-chan.receive-invalid ( -- )
  999999 chan.receive  # non-existent channel
  test.assert-not  # should return false (failure)
  drop  # drop the placeholder value
;
